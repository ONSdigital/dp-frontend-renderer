{{ template "partials/loop11" . }}
<div class="adjust-font-size--16">
   <div class="page-intro">
      <div class="wrapper">
         <div class="col-wrap">
            <div class="col">
               {{ template "partials/breadcrumb" . }}
               <div class="col col--md-47 col--lg-39">
                  <h1 class="page-intro__title font-weight-700">{{if not .NoDimensionData}}Preview of filtered dataset{{else}}We can't create a preview{{end}}</h1>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="page-content link-adjust">
      <div class="wrapper">
         <div class="col-wrap">
            <div class="col">
              {{if not .NoDimensionData}}
              {{if not .Data.IsLatestVersion}}
              <div class="alert margin-bottom--2 padding-right--1 padding-left--1">
                <div class="alert__title">This is not the latest release</div>
                <a class="btn btn--primary" href="{{.Data.LatestVersion.FilterJourneyWithLatestJourney}}"><strong>Apply these filters to the latest release</a>
                <a class="alert__link padding-left-md--1" href="{{.Data.LatestVersion.DatasetLandingPageURL}}">View latest release</a>
              </div>
              {{ end }}
              <a id="adjust-filter-options" href="/filters/{{.Data.FilterID}}/dimensions"><span class="icon icon-arrow-back--dark-small"></span>Adjust filter options</a>
              <ul class="list--neutral margin-bottom--3 margin-top--3">
                <li class="margin-top--0 margin-bottom--1"><span class="inline-block width--10">Title</span>{{.DatasetTitle}}</li>
                <li class="margin-top--0 margin-bottom--1"><span class="inline-block width--10">Dataset ID</span>{{.Data.DatasetID}}</li>
                <li class="margin-top--0 margin-bottom--1"><span class="inline-block width--10">Release date</span>{{dateFormat .Data.ReleaseDate}}</li>
                {{range .Data.SingleValueDimensions}}
                  <li class="margin-top--0 margin-bottom--1"><span class="inline-block width--10">{{.Name}}</span>{{ index .Values 0 }}</li>
                {{end}}
              </ul>
							{{if not .IsPreviewLoaded}}
              <meta http-equiv="refresh" content="2"/>
		 					<div class="border-top--gallery-sm border-top--gallery-md border-top--gallery-lg padding-top--2">
		 						  {{ template "partials/spinner" }}
		 						<p class="margin-top--0 padding-top--0 height--8">Please wait whle we generate your preview and files...</p>
		 					 </div>

		 					{{ else }}
               <div class="table-preview">
                  <table>
                     <thead>
                        <tr>
                           {{ range .Data.Dimensions }}
                           <th scope="col">{{.Name}}</th>
                           {{ end }}
                        </tr>
                     </thead>
                     <tbody>
                        {{ $dimensions := .Data.Dimensions }}
                        {{ range $i, $v := loop 0 (len (index $dimensions 0).Values ) }}
                        <tr>
                           {{ range $j, $dimension := $dimensions }}
                           <td>{{ index $dimension.Values $i }}</td>
                           {{ end }}
                        </tr>
                        {{ end }}
                     </tbody>
                  </table>
                  <p> Displaying rows 1-{{len (index .Data.Dimensions 0).Values}} of filtered dataset </p>
               </div>
               {{if not .IsDownloadLoaded}}
              <meta http-equiv="refresh" content="2"/>
		 					<div class="border-top--gallery-sm border-top--gallery-md border-top--gallery-lg padding-top--2">
		 						{{ template "partials/spinner" }}
		 						<p class="margin-top--0 padding-top--0 height--8">Please wait whle we generate your files...</p>
		 					 </div>

		 					{{ else }}
               <div class="margin-bottom--2">
                  <h2 class="margin-bottom">Download filtered dataset</h2>
                  {{ range .Data.Downloads}}
                  {{if not (eq .Size "") }}
                    {{if eq .Extension "xls"}}<a id="excel-download" class="btn btn--primary" href="{{.URI}}"><strong>Download Excel file</strong> <span class="font-size--14">({{ humanSize .Size }})</span></a>{{end}}
                  {{end}}
                  {{ end }}
                  <h3 class="margin-bottom">Other download options</h2>
                  {{ range .Data.Downloads}}
                  {{if not (eq .Size "") }}
                    {{if not (eq .Extension "xls")}}<a id="{{.Extension}}-download" class="btn btn--primary uppercase" href="{{.URI}}"><strong>{{.Extension}}</strong> <span class="font-size--14">({{ humanSize .Size }})</span></a>{{end}}
                  {{end}}
                  {{ end }}
               </div>
                <p>Refer to the <a id="dataset-page-link" href="{{.Data.LatestVersion.DatasetLandingPageURL}}">dataset page</a> for more information on this data.</p>
               {{end}}
               {{end}}
               {{else}}
               <div class="alert alert--light">
                 <p class="margin-bottom--half padding-bottom--0">Your selection were too specific, so there is no data to display</p>
                 <a class="inline-block margin-bottom--half" href="/filters/{{.Data.FilterID}}/dimensions">Please go back and adjust filter options</a>
               </div>
               {{end}}
            </div>
         </div>
      </div>
   </div>
</div>
