<!DOCTYPE html>
<html lang={{.Language}} xml:lang={{.Language}}>
<head>

    <title>{{ .Metadata.Title }} - {{ localise "OfficeForNationalStatistics" .Language 1 }}</title>
    <meta name="description" content="{{ .Metadata.Description}}">
    <meta name="keywords" content="{{range .Metadata.Keywords}} {{- .}}, {{end}}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8"/>
    <meta content="width=device-width,initial-scale=1.0,user-scalable=1" name="viewport">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#58595B">
    <meta name="apple-mobile-web-app-status-bar-style" content="#58595B">
    {{ if .Metadata.ServiceName }}<meta name="ons:service" content="{{ .Metadata.ServiceName}}">{{ end }}
		{{`<!--[if lte IE 8]>` | safeHTML}}
      <link rel="stylesheet" href="{{.PatternLibraryAssetsPath}}/css/old-ie.css">
		{{`<![endif]-->` | safeHTML}}
    {{`<!--[if IE 9]>` | safeHTML}}
      <link rel="stylesheet" href="{{.PatternLibraryAssetsPath}}/css/ie-9.css">
    {{`<![endif]-->` | safeHTML}}
		{{`<!--[if gt IE 9]><!-->` | safeHTML}}
      <link rel="stylesheet" href="{{.PatternLibraryAssetsPath}}/css/main.css">
    {{`<!--<![endif]-->` | safeHTML}}
    {{ if .EnableJSONLDControl }}
      {{ template "partials/json-ld/base" . }}
    {{ end }}

    <!-- Add page title to dataLayer - Google Tag Manager -->
    <script>
      // unescape html entities
      function htmlUnescape(str){
          return str
                  .replace(/&#x3D;/g, "=");
      }
      dataLayer = [{
        {{if .DatasetTitle }}
        "contentTitle": htmlUnescape({{.DatasetTitle}}),
        "filterTitle": htmlUnescape({{.Metadata.Title}}),
        {{else}}
        "contentTitle": htmlUnescape({{.Metadata.Title}}),
        {{end}}
        {{if .ReleaseDate }}
        "releaseDate": {{dateFormatYYYYMMDD .ReleaseDate}}
        {{end}}
      }];
    </script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MBCBVQS');</script>
    <!-- End Google Tag Manager -->
</head>
<body class="{{ .Type }}">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MBCBVQS"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
    {{ if .EnableCookiesControl }}
      {{ template "partials/cookies-banner" . }}
    {{ end }}
    {{ template "partials/header" . }}

    <main id="main" role="main" tabindex="-1">
      {{yield}}
    </main>

    {{ template "partials/footer" . }}

    {{`<!--[if gt IE 8]><!-->` | safeHTML}}
      {{/* TODO - update on live build to use two JS files, not a single one */}}
      <script type="text/javascript" src="{{.PatternLibraryAssetsPath}}/js/main.js"></script>
      <script type="text/javascript" src="/js/app.js"></script>
    {{`<!--<![endif]-->` | safeHTML}}
</body>
</html>
